(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){},25:function(e,t,n){e.exports=n(38)},38:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(19),i=n.n(r),c=n(4),s=n(3),l=n(6),u=n(5),m=n(7),h=n(1),d=(n(17),n(10),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"render",value:function(){return o.a.createElement("header",{className:"masthead d-flex"},o.a.createElement("div",{className:"container text-center my-auto"},o.a.createElement("h1",{className:"mb-1 title-text"},"Office Hours Queue"),o.a.createElement("a",{className:"btn btn-primary btn-margin btn-xl",href:"/signup"},"Sign up"),o.a.createElement("a",{className:"btn btn-primary btn-margin btn-xl",href:"/login"},"Log in")),o.a.createElement("div",{className:"overlay"}))}}]),t}(o.a.Component)),p=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("center",null,o.a.createElement("h2",{class:"queue-title"},this.props.queue.name),o.a.createElement("p",{class:"wait-time"},"Average Wait Time: ",o.a.createElement("br",null),this.props.queue.average_wait_time," Minutes"),o.a.createElement("a",{href:"/"+this.props.queue.name+"/ask",class:"ask-link"},"Ask Question"),o.a.createElement("table",{class:"queue"},o.a.createElement("tr",null,o.a.createElement("th",null,"Name")),this.props.queue.question_contents.map(function(e,t){return o.a.createElement("tr",null,o.a.createElement("td",null,t+1," - ",e.first_name," ",e.last_name))}))))}}]),t}(o.a.Component),f=n(41),b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).logout=n.logout.bind(Object(h.a)(Object(h.a)(n))),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"logout",value:function(){localStorage.removeItem("credentials"),this.props.history.push("/login")}},{key:"render",value:function(){var e=window.innerWidth,t=this.props.queues.length;(0==t||e<800)&&(t=1);var n={width:(100/t).toString()+"vw"};return e<800?o.a.createElement("div",null,o.a.createElement("div",{class:"top-right"},o.a.createElement("button",{className:"btn btn-primary",onClick:this.logout},"Log out")),o.a.createElement("div",{class:"verticalList"},this.props.queues.map(function(e,t){return o.a.createElement("div",{style:n,class:"queue-table"},o.a.createElement(p,{queue:e}))}))):o.a.createElement("div",null,o.a.createElement("div",{class:"top-right"},o.a.createElement("button",{className:"btn btn-primary btn-xl",onClick:this.logout},"Log out")),o.a.createElement("div",{class:"horizontalList"},this.props.queues.map(function(e,t){return o.a.createElement("div",{style:n,class:"queue-table"},o.a.createElement(p,{queue:e}))})))}}]),t}(o.a.Component),v=Object(f.a)(b),E=function(){function e(){Object(c.a)(this,e),this.callbacks={},this.socketRef=null}return Object(s.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),Object(s.a)(e,[{key:"connect",value:function(){var e=this,t=document.location.host,n="wss://"+t+"/ws/ohqueue";"https:"!==window.location.protocol&&(n="ws://"+t+"/ws/ohqueue"),this.socketRef=new WebSocket(n),this.socketRef.onopen=function(){},this.socketRef.onmessage=function(t){e.callbacks.set(JSON.parse(t.data))},this.socketRef.onerror=function(e){},this.socketRef.onclose=function(){e.connect()}}},{key:"addCallbacks",value:function(e){this.callbacks.set=e}},{key:"state",value:function(){return this.socketRef.readyState}},{key:"waitForSocketConnection",value:function(e){var t=this.socketRef,n=this.waitForSocketConnection;setTimeout(function(){1!==t.readyState?n(e):null!=e&&e()},1)}}]),e}();E.instance=null;var g=E.getInstance(),y=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).fetchData=n.fetchData.bind(Object(h.a)(Object(h.a)(n))),n.state={isLoggedIn:!1,queues:[]},g.connect(),n.waitForSocketConnection(function(){g.addCallbacks(n.update.bind(Object(h.a)(Object(h.a)(n))))}),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout(function(){1!==g.state()?t.waitForSocketConnection(e):e()},100)}},{key:"fetchData",value:function(){var e=this;fetch("/api/v1/queue/list/",{method:"GET",headers:{Authorization:"Token "+localStorage.getItem("credentials")}}).then(function(e){return e.json()}).then(function(t){t.detail?t.detail.localeCompare("Invalid token."):(e.setState({isLoggedIn:!0}),e.setState({queues:t}))})}},{key:"update",value:function(e){this.fetchData(),this.forceUpdate()}},{key:"componentDidMount",value:function(){document.title="Online OH Queue",this.fetchData()}},{key:"render",value:function(){return this.state.isLoggedIn?o.a.createElement("div",null,o.a.createElement(v,{queues:this.state.queues})):o.a.createElement("div",{id:"landing-page"},o.a.createElement(d,null))}}]),t}(a.Component),k=n(14),O=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={description:""},e.onChange=e.onChange.bind(Object(h.a)(Object(h.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(h.a)(Object(h.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=new FormData(e.target),a="/api/v1/queue/"+this.props.match.params.queue+"/ask";fetch(a,{method:"POST",body:n,headers:{Authorization:"Token "+localStorage.getItem("credentials")}}).then(function(e){if(!e.ok)return e.json();t.props.history.push("/")}).then(function(e){"undefined"===typeof e||(document.getElementById("validationError").innerHTML=e)})}},{key:"onChange",value:function(e){var t=280-e.target.value.length;document.getElementById("description_label").innerHTML="Question Description ("+t.toString()+" Characters Remaining)",this.setState(Object(k.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return o.a.createElement("div",{class:"formBg"},o.a.createElement("div",{class:"question-page"},o.a.createElement("div",{class:"questionForm"},o.a.createElement("form",{class:"login-form",onSubmit:this.handleSubmit},o.a.createElement("h2",{class:"header-login"},o.a.createElement("center",null,"Ask A Question")),o.a.createElement("label",{htmlFor:"description",id:"description_label"},"Question Description (280 Characters Remaining):"),o.a.createElement("textarea",{maxlength:"280",id:"description",name:"description",value:this.state.question,onChange:this.onChange}),o.a.createElement("button",{class:"margin-top-button"},"submit"),o.a.createElement("p",{id:"validationError",class:"validationErrorText"})))))}}]),t}(o.a.Component),j=n(22),w=n.n(j),q=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).answerQuestion=e.answerQuestion.bind(Object(h.a)(Object(h.a)(e))),e.extendQueue=e.extendQueue.bind(Object(h.a)(Object(h.a)(e))),e.closeQueue=e.closeQueue.bind(Object(h.a)(Object(h.a)(e))),e.state={csrftoken:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue";var e=null;if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var a=w.a.trim(t[n]);if("csrftoken="===a.substring(0,"csrftoken".length+1)){e=decodeURIComponent(a.substring("csrftoken".length+1));break}}this.setState({csrftoken:e}),fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"extendQueue",value:function(e){fetch("/api/v1/queue/open/",{method:"POST",body:JSON.stringify({queue:this.props.queue.name}),headers:{Authorization:"Token "+localStorage.getItem("credentials"),"X-CSRFToken":this.state.csrftoken}}).then(function(e){return e.json()}).then(function(e){e.success})}},{key:"closeQueue",value:function(e){fetch("/api/v1/queue/close/",{method:"POST",body:JSON.stringify({queue:this.props.queue.name}),headers:{Authorization:"Token "+localStorage.getItem("credentials"),"X-CSRFToken":this.state.csrftoken}}).then(function(e){return e.json()}).then(function(e){e.success})}},{key:"answerQuestion",value:function(e){fetch("/api/v1/questions/answer/",{method:"POST",body:JSON.stringify({queue:this.props.queue.name,question_id:e}),headers:{Authorization:"Token "+localStorage.getItem("credentials"),"X-CSRFToken":this.state.csrftoken}}).then(function(e){return e.json()}).then(function(e){e.success})}},{key:"render",value:function(){var e,t=this,a=this.answerQuestion,r=this.extendQueue,i=this.closeQueue,c=n(35),s=c({"answer-link":!this.props.queue.is_open_extended,"answer-link-selected":this.props.queue.is_open_extended}),l=c({"answer-link":!this.props.queue.is_closed,"answer-link-selected":this.props.queue.is_closed});return e=this.props.queue.is_closed?o.a.createElement("p",{class:"queue-status"},"Queue Closed Manually"):this.props.queue.is_open_extended?o.a.createElement("p",{class:"queue-status"},"Queue Open"):this.props.queue.is_in_time?o.a.createElement("p",{class:"queue-status"},"Queue Open"):o.a.createElement("p",{class:"queue-status"},"Queue Closed Because Of Schedule"),o.a.createElement("div",null,o.a.createElement("center",null,o.a.createElement("h2",{class:"queue-title"},this.props.queue.name),e,o.a.createElement("p",{class:"wait-time"},"Average Wait Time: ",o.a.createElement("br",null),this.props.queue.average_wait_time," Minutes"),o.a.createElement("button",{onClick:function(){return r(t.props.queue.name)},className:s},"Keep Queue Open"),o.a.createElement("button",{onClick:function(){return i(t.props.queue.name)},className:l},"Close Queue Manually"),o.a.createElement("table",{class:"queue"},o.a.createElement("tr",null,o.a.createElement("th",null,"Student")),this.props.queue.question_contents.map(function(e,t){return o.a.createElement("tr",null,o.a.createElement("td",null,t+1," - ",e.first_name," ",e.last_name,o.a.createElement("br",null)," Question: ",e.question_content,o.a.createElement("br",null),o.a.createElement("center",null,o.a.createElement("button",{onClick:function(){return a(e.id)},class:"answer-link"},"Answer"))))}))))}}]),t}(o.a.Component),S=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).fetchData=n.fetchData.bind(Object(h.a)(Object(h.a)(n))),n.state={isTA:!1,queues:[]},g.connect(),n.waitForSocketConnection(function(){g.addCallbacks(n.update.bind(Object(h.a)(Object(h.a)(n))))}),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout(function(){1!==g.state()?t.waitForSocketConnection(e):e()},100)}},{key:"fetchData",value:function(){var e=this;fetch("/api/v1/users/is_ta",{method:"GET",headers:{Authorization:"Token "+localStorage.getItem("credentials")}}).then(function(e){return e.json()}).then(function(t){t.is_ta?(e.setState({isTA:!0}),fetch("/api/v1/queue/list_ta/",{method:"GET",headers:{Authorization:"Token "+localStorage.getItem("credentials")}}).then(function(e){return e.json()}).then(function(t){t.detail||e.setState({queues:t})})):e.setState({isTA:!1})})}},{key:"update",value:function(e){this.fetchData(),this.forceUpdate()}},{key:"componentDidMount",value:function(){document.title="Online OH Queue",this.fetchData(),fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"render",value:function(){if(this.state.isTA){var e=window.innerWidth,t=this.state.queues.length;(0==t||e<800)&&(t=1);var n={width:(100/t).toString()+"vw"};return e<800?o.a.createElement("div",null,o.a.createElement("div",{class:"top-right"},o.a.createElement("button",{className:"btn btn-primary",onClick:this.logout},"Log out")),o.a.createElement("div",{class:"verticalList"},this.state.queues.map(function(e,t){return o.a.createElement("div",{style:n,class:"queue-table"},o.a.createElement(q,{queue:e}))}))):o.a.createElement("div",null,o.a.createElement("div",{class:"top-right"},o.a.createElement("button",{className:"btn btn-primary btn-xl",onClick:this.logout},"Log out")),o.a.createElement("div",{class:"horizontalList"},this.state.queues.map(function(e,t){return o.a.createElement("div",{style:n,class:"queue-table"},o.a.createElement(q,{queue:e}))})))}return o.a.createElement("p",null,"You do not have appropriate permissions to access this page")}}]),t}(a.Component),_=n(23),C=n.n(_),T=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={validationErrors:[]},n.handleSubmit=n.handleSubmit.bind(Object(h.a)(Object(h.a)(n))),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"handleValidation",value:function(e){var t=!1,n=[],a=e.get("email"),o=e.get("first_name"),r=e.get("last_name"),i=e.get("password");return-1==a.indexOf("upenn.edu")&&(n.push("Must have a penn email"),t=!0),0==o.length&&(n.push("First name cannot be blank"),t=!0),0==r.length&&(n.push("Last name cannot be blank"),t=!0),i.length<8&&(n.push("Password must be at least 8 characters"),t=!0),t&&this.setState({validationErrors:this.state.validationErrors.concat(n)}),!t}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=new FormData(e.target);this.handleValidation(n)&&fetch("/api/v1/users/register/",{method:"POST",body:n}).then(function(e){if(e.ok)C()("Email Confirmation Sent!","Please check your email to confirm your account","success"),document.getElementById("email").value="",document.getElementById("first_name").value="",document.getElementById("last_name").value="",document.getElementById("password").value="";else{t.setState({validationErrors:t.state.validationErrors.concat(["Email is taken"])})}})}},{key:"render",value:function(){return o.a.createElement("div",{class:"formBg"},o.a.createElement("div",{class:"login-page"},o.a.createElement("div",{class:"userForm"},o.a.createElement("form",{class:"login-form",onSubmit:this.handleSubmit},o.a.createElement("h2",{class:"header-login"},o.a.createElement("center",null,"Sign Up")),o.a.createElement("label",{htmlFor:"email"},"Enter Penn Email"),o.a.createElement("input",{id:"email",name:"email",type:"email"}),o.a.createElement("label",{htmlFor:"first_name"},"First Name"),o.a.createElement("input",{id:"first_name",name:"first_name",type:"text"}),o.a.createElement("label",{htmlFor:"last_name"},"Last Name"),o.a.createElement("input",{id:"last_name",name:"last_name",type:"text"}),o.a.createElement("label",{htmlFor:"password"},"Password"),o.a.createElement("input",{id:"password",name:"password",type:"password"}),o.a.createElement("button",null,"Sign Up")),o.a.createElement("br",null),o.a.createElement("ul",{class:"validationErrorList"},this.state.validationErrors.map(function(e,t){return o.a.createElement("li",null,e)})))))}}]),t}(o.a.Component),Q=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={email:"",password:""},e.onChange=e.onChange.bind(Object(h.a)(Object(h.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(h.a)(Object(h.a)(e))),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.title="Online OH Queue",fetch("/api/v1/theme/",{method:"GET"}).then(function(e){return e.json()}).then(function(e){document.body.style.setProperty("--primary-color",e.primary_theme_color)})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=new FormData(e.target);fetch("/api/v1/users/login/",{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){e.error?alert("Invalid login"):(localStorage.setItem("credentials",e.token),t.props.history.push("/"))})}},{key:"onChange",value:function(e){this.setState(Object(k.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return o.a.createElement("div",{class:"formBg"},o.a.createElement("div",{class:"login-page"},o.a.createElement("div",{class:"userForm"},o.a.createElement("form",{class:"login-form",onSubmit:this.handleSubmit},o.a.createElement("h2",{class:"header-login"},o.a.createElement("center",null,"Log in")),o.a.createElement("label",{htmlFor:"email"},"Penn Email"),o.a.createElement("input",{id:"email",name:"email",type:"email",value:this.state.email,onChange:this.onChange}),o.a.createElement("label",{htmlFor:"password"},"Password"),o.a.createElement("input",{id:"password",name:"password",type:"password",value:this.state.password,onChange:this.onChange}),o.a.createElement("button",null,"login"),o.a.createElement("p",{class:"message"},"Not registered? ",o.a.createElement("a",{href:"/signup"},"Create an account")),o.a.createElement("p",{class:"message"},"Forget your password? ",o.a.createElement("a",{href:"/password_reset"},"Reset your password"))))))}}]),t}(o.a.Component),D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={questions:[]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/api/v1/summary",{method:"GET",headers:{Authorization:"Token "+localStorage.getItem("credentials")}}).then(function(e){return e.json()}).then(function(t){e.setState({questions:t})})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("center",null,o.a.createElement("h2",null,"Office Hours Questions This Week:")),o.a.createElement("table",{class:"summary"},o.a.createElement("tr",null,o.a.createElement("th",null,"Question"),o.a.createElement("th",null,"Answerer")),this.state.questions.map(function(e,t){return o.a.createElement("tr",null,o.a.createElement("td",{class:"description"},t+1," - ",e.description),o.a.createElement("td",{class:"answerer"},e.answered_by_email))})))}}]),t}(a.Component),F=n(40),x=n(42),I=n(39);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(F.a,null,o.a.createElement(x.a,null,o.a.createElement(I.a,{exact:!0,path:"/",component:y}),o.a.createElement(I.a,{exact:!0,path:"/signup",component:T}),o.a.createElement(I.a,{exact:!0,path:"/login",component:Q}),o.a.createElement(I.a,{exact:!0,path:"/answer",component:S}),o.a.createElement(I.a,{exact:!0,path:"/summary",component:D}),o.a.createElement(I.a,{path:"/:queue/ask",component:O}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[25,2,1]]]);
//# sourceMappingURL=main.c32ce3a3.chunk.js.map